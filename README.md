# Jittor 超声图像 BI-RADS 分类 | Swin Transformer + 渐进解冻

> 使用 **Jittor** 框架实现的乳腺超声图像 **BI-RADS 等级分类**基线方案，采用 **Swin Transformer** 主干与**渐进式解冻**训练策略，结合医学影像特有的数据增强与混合损失，提升在小样本条件下的鲁棒性与泛化能力。

---

## 项目概述

**核心任务**  
基于 Jittor 搭建高性能的超声图像分类系统，准确识别乳腺超声图像的 **BI-RADS** 分类等级。

**解决思路**  
- 以 **Swin Transformer** 作为主干网络；  
- 采用**分阶段/渐进式解冻**策略（先训分类头 → 解冻深层 → 逐步扩展）；  
- 针对医学影像设计的增强：**病灶缩放、阴影条带、对比度扰动、噪声等**；  
- **混合损失**：标签平滑交叉熵 + 类别关系/分布约束，缓解类别边界模糊；  
- **TTA**（水平/垂直翻转、中心裁剪）提升推理稳定性；  
- 训练实用策略：**AMP 混合精度、余弦退火、AdamW（主干/头部分组学习率）、早停、梯度累积** 等。

---

## 环境与依赖

- OS：**Ubuntu 22.04.1 LTS**（示例环境）
- GPU：**NVIDIA RTX 4090**（示例环境）
- CUDA：**11.8 / 11.7**（均可）
- Python：**≥ 3.8**
- Jittor：**≥ 1.3.0**
- 依赖生态：**jimm (Jittor Image Models)** 等

> 注：项目使用了 Jittor 推荐的 **jimm** 库，安装与使用请按其官方说明进行。

# 安装项目依赖
pip install -r requirements.txt

---

## 模块说明（摘自实现要点）

- **模型构建**：Swin Transformer 主干，支持分阶段解冻与参数分组优化；  
- **医学数据增强**：病灶缩放、阴影条带、对比度扰动、噪声等；  
- **混合损失函数**：标签平滑交叉熵 + 类别关系/分布约束；  
- **动态训练策略**：解冻调度、余弦退火学习率、TTA；  
- **数据加载**：支持 `trainval_balanced.txt`，自适应绝对/相对路径；  
- **混合精度训练（AMP）**：提速并降低显存占用；  
- **早停机制**：基于验证损失监控，防止过拟合；  
- **优化器配置**：AdamW，主干与分类头区分学习率（建议 1:4）；  
- **训练流程控制**：完整训练/验证循环、模型保存、日志记录与梯度累积。

---

## 注意事项

- 项目 **Description** 与 **Topics** 建议包含关键词：`jittor`, `ultrasound`, `classification`, `bi-rads`；  
- 若涉及私有或敏感数据，请在开源前进行脱敏与合规检查；  
- 请确保第三方依赖许可证与本仓库许可证兼容。

---

## 致谢

- 感谢 **Jittor** 与 **jimm (Jittor Image Models)** 开源生态；  

---

## 许可证

使用 **Apache-2.0**。请在仓库根目录放置 `LICENSE` 文件。
